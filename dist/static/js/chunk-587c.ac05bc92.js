(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-587c"],{"+gE7":function(t,e,a){"use strict";a.r(e);var n=a("2XhK"),r=a("xIWA");for(var o in r)["default"].indexOf(o)<0&&function(t){a.d(e,t,function(){return r[t]})}(o);var s=a("KHd+"),i=Object(s.a)(r.default,n.a,n.b,!1,null,null,null);i.options.__file="_table-summary-single.vue",e.default=i.exports},"/HKH":function(t,e,a){"use strict";a.r(e);var n=a("KHWC"),r=a("qu+I");for(var o in r)["default"].indexOf(o)<0&&function(t){a.d(e,t,function(){return r[t]})}(o);var s=a("KHd+"),i=Object(s.a)(r.default,n.a,n.b,!1,null,null,null);i.options.__file="Index.vue",e.default=i.exports},"2XhK":function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return r});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{data:t.data}},[a("el-table-column",{attrs:{label:t.$lang[t.langId].date,"min-width":"120",prop:"fdate"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].employee,"min-width":"100",prop:"employee_name"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].shift_work,"min-width":"200",prop:"fshift_datetime"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].time_coming,"min-width":"120",prop:"time_coming"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].time_going,"min-width":"120",prop:"time_going"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].duration,"min-width":"120",prop:"fduration_shift"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].time_earlier,"min-width":"145",prop:"ftime_earlier"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].flated,"min-width":"125",prop:"ftime_late"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].left_early,"min-width":"140",prop:"fcome_home_early"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].fOvertime,"min-width":"120",prop:"fovertime"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].note,"min-width":"120",prop:"note"}})],1),t._v(" "),t.total>0?a("div",{staticClass:"table-handler-bottom"},[a("el-pagination",{attrs:{total:t.total,"page-sizes":[50,100],"page-size":15,"current-page":t.currentPage,background:"",layout:"sizes, prev, pager, next"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleChangePage,"size-change":t.handleChangeSizePage}})],1):t._e()],1)},r=[]},"6Az4":function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return r});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{attrs:{data:t.data}},[a("el-table-column",{attrs:{label:t.$lang[t.langId].employee,"min-width":"120",prop:"employee_name"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].duration,"min-width":"180",prop:"fduration"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].overtime,"min-width":"180",prop:"fovertime"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].time_earlier,"min-width":"180",prop:"ftime_earlier"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].time_late,"min-width":"180",prop:"ftime_late"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$lang[t.langId].left_early,"min-width":"180",prop:"fcome_home_early"}})],1),t._v(" "),t.total>0?a("div",{staticClass:"table-handler-bottom"},[a("el-pagination",{attrs:{total:t.total,"page-sizes":[50,100],"page-size":15,"current-page":t.currentPage,background:"",layout:"sizes, prev, pager, next"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e},"current-change":t.handleChangePage,"size-change":t.handleChangeSizePage}})],1):t._e()],1)},r=[]},CPhp:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"TableDetail",props:["data","lang","summary","total"],computed:{langId:function(){return this.$store.state.userStores.langId}},methods:{showDetailData:function(t,e){this.$emit("showdetaildata",t,e)},handleChangePage:function(t){this.$emit("changePage",t)},handleChangeSizePage:function(t){this.$emit("changeSizePage",t)}}}},KHWC:function(t,e,a){"use strict";a.d(e,"a",function(){return n}),a.d(e,"b",function(){return r});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"report-page"},[a("report-list",{attrs:{showlist:t.showlist,"selected-report-by-search":t.selectedReportBySearch,paths:t.paths},on:{"update:selectedReportBySearch":function(e){t.selectedReportBySearch=e},"update:selected-report-by-search":function(e){t.selectedReportBySearch=e},"show-report":t.showReport}}),t._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"table-handler-flex",attrs:{slot:"header"},slot:"header"},[a("h4",{staticClass:"pointer",staticStyle:{"flex-grow":"1"},on:{click:t.toggleReportList}},[a("span",{staticClass:"trigger-open-report-list"},[a("svg-icon",{attrs:{"icon-class":"arrow-left"}})],1),t._v("\n        "+t._s(t.activeReport.label)+"\n      ")]),t._v(" "),a("div",[t.activeReport.withoutDate?t._e():a("date-range-picker",{attrs:{"init-date":t.initParamDate,size:"mini"},on:{picked:t.getDataFiltered}}),t._v(" "),a("el-button",{attrs:{loading:t.loadingDownloadPdf,size:"mini",icon:"el-icon-printer"},on:{click:function(e){return t.getPDF(t.activeReport.path)}}},[t._v("\n          PDF\n        ")]),t._v(" "),a("el-button",{attrs:{loading:t.loadingDownloadExcel,size:"mini",icon:"el-icon-document"},on:{click:function(e){return t.getExcel(t.activeReport.path)}}},[t._v("\n          EXCEL\n        ")])],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"card-body"},["summary"===t.activeReport.path?a("div",[a(t.loadedComponent,{tag:"component",attrs:{data:t.data,summary:t.summary,lang:t.lang,"lang-id":t.langId,total:t.total,token:t.token,store:t.selectedStore,params:t.params},on:{changePage:t.handleChangePage,changeSizePage:t.handleChangeSizePage}})],1):t._e(),t._v(" "),"reports_attendance_single"===t.activeReport.path?a("div",[a("table-summary-single",{attrs:{data:t.data,lang:t.lang,summary:t.summary,total:t.total},on:{showdetaildata:t.showDetailData,changePage:t.handleChangePage,changeSizePage:t.handleChangeSizePage}})],1):t._e()])])],1)},r=[]},"Lwh/":function(t,e,a){"use strict";a.r(e);var n=a("bNRI"),r=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,function(){return n[t]})}(o);e.default=r.a},PCJS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=g(a("m1cH")),r=g(a("14Xm")),o=g(a("D3Ub")),s=g(a("QbLZ")),i=a("xCek"),l=g(a("vDqi")),d=g(a("hogc")),c=a("L9QE"),u=g(a("uJg8")),p=g(a("+gE7")),h=g(a("5QMf")),m=g(a("lj28"));function g(t){return t&&t.__esModule?t:{default:t}}var f=a("wd/R"),_=(f().format("YYYY-MM-DD"),f().format("YYYY-MM-DD")),v="attendance/presence";e.default={name:"ReportAttendance",components:{dateRangePicker:d.default,TableSummary:u.default,ReportList:h.default,TableSummarySingle:p.default},mixins:[m.default],data:function(){return{loading:!1,data:[],summary:[],showlist:!0,selectedReportBySearch:"salessummary",paths:[{path:"summary",label:this.$lang[this.$store.state.userStores.langId].reports_attendance,path_key:"summary",active:!0},{path:"reports_attendance_single",label:this.$lang[this.$store.state.userStores.langId].reports_attendance_single,path_key:"reports_attendance_single",active:!1}],params:{sort_column:["date","employee_name"],sort_type:["desc","asc"],searchQuery:"",page:1,search_column:["date","date"],search_text:[_,_],search_operator:[">=","<="]},date:{start_date:f().format("YYYY-MM-DD"),end_date:f().format("YYYY-MM-DD")},total:0,productstock_SortTypes:["name","category","stock_qty"],storeBranches:[],dataEmployee:[],loadingDownloadPdf:!1,loadingDownloadExcel:!1}},watch:{"$store.getters.selectedStore":function(){this.getData(this.activeReport.path)},lang:{handler:function(t){var e=this;this.paths.map(function(t){t.label=e.$lang[e.langId].item.path_key})},deep:!0,immediate:!0}},mounted:function(){this.getClientEmployee()},methods:{getData:function(t,e){var a=this;if(console.log("qweqweqweqw",t),"summary"===t){this.data=[],this.summary=[],this.loading=!0;void 0===e?this.params.page="":e||(this.params.page="");var n={Authorization:"Bearer "+this.token.access_token};this.params.store_id||(this.params.store_id=this.selectedStore.store_id),(0,l.default)({method:"GET",url:(0,i.baseApi)(this.selectedStore.url_id,this.langId,v+"/"+t),params:this.params,headers:n}).then(function(t){a.data=t.data.data,t.data.totaldata&&(a.summary=t.data.totaldata),t.data.meta&&(a.total=t.data.meta.total),a.loading=!1}).catch(function(t){a.loading=!1,404!==t.response.status&&(a.$notify({type:"error",title:"Error"+t.response.status,message:t.response.statusText}),a.loading=!1),a.data=[],a.total=0,a.loading=!1})}else if("reports_attendance_single"===t){this.data=[],this.summary=[],this.loading=!0;void 0===e?this.params.page="":e||(this.params.page="");var r={Authorization:"Bearer "+this.token.access_token};this.params.store_id||(this.params.store_id=this.selectedStore.store_id),(0,l.default)({method:"GET",url:(0,i.baseApi)(this.selectedStore.url_id,this.langId,"attendancereport/presence/detail"),params:this.params,headers:r}).then(function(t){a.data=t.data.data,t.data.totaldata&&(a.summary=t.data.totaldata),t.data.meta&&(a.total=t.data.meta.total),a.loading=!1}).catch(function(t){a.loading=!1,404!==t.response.status&&(a.$notify({type:"error",title:"Error"+t.response.status,message:t.response.statusText}),a.loading=!1),a.data=[],a.total=0,a.loading=!1})}},getFileMobile:function(t,e){this.setLocalStorageForBackAfterDownload();var a=this.activeReport.label+"-"+this.params.search_text[0]+"__"+this.params.search_text[1]+"."+e,n="?sort_column[]="+this.params.sort_column[0]+"&sort_column[]="+this.params.sort_column[1]+"&sort_type[]="+this.params.sort_type[0]+"&sort_type[]="+this.params.sort_type[1]+"&search_column[]="+this.params.search_column[0]+"&search_column[]="+this.params.search_column[1]+"&search_text[]="+this.params.search_text[0]+"&search_text[]="+this.params.search_text[1]+"&search_operator[]="+this.params.search_operator[0]+"&search_operator[]="+this.params.search_operator[1]+"&store_id="+this.params.store_id+"&employee_id="+this.params.employee_id+"&type="+e,r="/download/api/"+this.selectedStore.url_id+"/admin/v1/"+this.langId+"/"+v+"/"+t;window.location.href=r+n+","+a},getPDF:function(t){var e=this;if(console.log(t),this.$store.getters.webviewMode)this.getFileMobile(t,"pdf");else{this.loadingDownloadPdf=!0;var a={Authorization:"Bearer "+this.token.access_token},n=(0,s.default)({},this.params);n.type="pdf",console.log(n),"reports_attendance_single"===t?(0,l.default)({url:(0,i.baseApi)(this.selectedStore.url_id,this.langId,"attendancereport/presence/detail"),method:"GET",responseType:"blob",headers:a,params:n}).then(function(t){e.loadingDownloadPdf=!1;var a=e.activeReport.label+"-"+e.params.search_text[0]+"__"+e.params.search_text[1]+".pdf",n=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=n,r.setAttribute("download",a),document.body.appendChild(r),r.click()}).catch(function(t){e.loadingDownloadPdf=!1}):(0,l.default)({url:(0,i.baseApi)(this.selectedStore.url_id,this.langId,v+"/"+t),method:"GET",responseType:"blob",headers:a,params:n}).then(function(t){e.loadingDownloadPdf=!1;var a=e.activeReport.label+"-"+e.params.search_text[0]+"__"+e.params.search_text[1]+".pdf",n=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=n,r.setAttribute("download",a),document.body.appendChild(r),r.click()}).catch(function(t){e.loadingDownloadPdf=!1})}},getExcel:function(t){var e=this;if(this.$store.getters.webviewMode)this.getFileMobile(t,"xlsx");else{this.loadingDownloadExcel=!0;var a={Authorization:"Bearer "+this.token.access_token},n=(0,s.default)({},this.params);n.type="xlsx",(0,l.default)({url:(0,i.baseApi)(this.selectedStore.url_id,this.langId,v+"/"+t),method:"GET",responseType:"blob",headers:a,params:n}).then(function(t){var a=e.activeReport.label+"-"+e.params.search_text[0]+"__"+e.params.search_text[1]+".xlsx",n=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=n,r.setAttribute("download",a),document.body.appendChild(r),r.click(),e.loadingDownloadExcel=!1}).catch(function(t){e.loadingDownloadExcel=!1})}},showReport:function(t,e){var a=this;return(0,o.default)(r.default.mark(function e(){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.paths.map(function(t){return t.active=!1,t});case 2:return a.paths=e.sent,e.next=5,a.paths.map(function(e){return e.path===t&&(e.active=!0),e});case 5:a.paths=e.sent,n="/reports/attendance",a.$store.getters.webviewMode&&(n="/reports-mobile/attendance"),"summary"===t&&(a.params.search_text=[f().format("YYYY-MM-DD"),f().format("YYYY-MM-DD")]),a.$router.push({path:n,query:{path:t}}),a.getData(t);case 11:case"end":return e.stop()}},e,a)}))()},getDataFiltered:function(t){this.params.page=1,t?(this.date=t,this.params.search_text=[this.date.start_date,this.date.end_date],this.getData(this.activeReport.path)):this.getData(this.activeReport.path)},handleChangePage:function(t){this.params.page=t;this.getData(this.activeReport.path,!0)},handleChangeSizePage:function(t){this.params.per_page=t,this.params.page=1;this.getData(this.activeReport.path,!0)},getClientEmployee:function(){var t=this;(0,c.clientEmployeeList)({per_page:100}).then(function(e){t.dataEmployee=[].concat((0,n.default)(e.data.data))})},handleFilterbyEmployee:function(t){console.log("vbnvbnvbnvb",t),this.params.page=1,this.params.employee_id=t,console.log("czxczxczxczxczxc",this.activeReport.path),this.getData(this.activeReport.path)}},beforeRouteEnter:function(t,e,a){var n=this,s="summary";t.query.path&&(s=t.query.path),a(function(){var t=(0,o.default)(r.default.mark(function t(a){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.setDefaultParamsFromLocalStorage(a,e);case 2:a.paths&&(a.paths=a.paths.map(function(t){return t.path===s?t.active=!0:t.active=!1,t}));case 3:case"end":return t.stop()}},t,n)}));return function(e){return t.apply(this,arguments)}}())}}},bNRI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"TableReportsPresence",props:["data","lang","summary","langId","total"],methods:{handleChangePage:function(t){this.$emit("changePage",t)},handleChangeSizePage:function(t){this.$emit("changeSizePage",t)},showOpenorder:function(t){this.$router.push("/sales/openorder/"+t.id)}}}},"qu+I":function(t,e,a){"use strict";a.r(e);var n=a("PCJS"),r=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,function(){return n[t]})}(o);e.default=r.a},uJg8:function(t,e,a){"use strict";a.r(e);var n=a("6Az4"),r=a("Lwh/");for(var o in r)["default"].indexOf(o)<0&&function(t){a.d(e,t,function(){return r[t]})}(o);var s=a("KHd+"),i=Object(s.a)(r.default,n.a,n.b,!1,null,null,null);i.options.__file="_table-summary.vue",e.default=i.exports},xIWA:function(t,e,a){"use strict";a.r(e);var n=a("CPhp"),r=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,function(){return n[t]})}(o);e.default=r.a}}]);