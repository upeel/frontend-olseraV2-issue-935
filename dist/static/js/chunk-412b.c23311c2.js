(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-412b"],{"+rog":function(e,t,a){"use strict";a.r(t);var s=a("4x8u"),i=a.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,function(){return s[e]})}(n);t.default=i.a},"4x8u":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(a("P2sY")),i=o(a("QbLZ")),n=o(a("m1cH"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={name:"FormStaff",props:["isedit","staff","saved","loading","formData","roleOptions","selectedRole"],data:function(){return{disabledSave:!0,dialogVisible:!1,data:{role_id:this.selectedRole},roles:[].concat((0,n.default)(this.roleOptions))}},computed:{selectedStore:function(){return this.$store.getters.selectedStore},token:function(){return this.$store.state.user.token},lang:function(){return this.$store.state.userStores.lang},langId:function(){return this.$store.state.userStores.langId},loggedInUserRole:function(){var e=this.$store.getters.selectedStore;return{role_id:e.role_id,role_name:e.role_name,is_pos_only:e.is_pos_only,is_mobile:e.is_mobile}},computedRoleOptions:function(){return"OW"!==this.loggedInUserRole.role_id?(this.staff&&this.staff.email&&0===this.staff.email.length&&this.roles.map(function(e){e.disabled=!1,"PS"!==e.id&&"PO"!==e.id&&(e.disabled=!0)}),this.roles.filter(function(e){return"OW"!==e.id})):(this.staff&&this.staff.email&&0===this.staff.email.length&&this.roles.map(function(e){e.disabled=!1,"PS"!==e.id&&"PO"!==e.id&&(e.disabled=!0)}),this.roles)}},watch:{data:{handler:function(e){e.name&&""!==e.name&&e.role_id&&""!==e.role_id?this.disabledSave=!1:this.disabledSave=!0},deep:!0,immediate:!0},saved:{handler:function(e){!0===e&&(this.data={},this.disabledSave=!0)},deep:!0},staff:{handler:function(e){e&&(this.data=(0,i.default)({},e),this.data.is_server=parseInt(this.data.is_server))}}},methods:{cancel:function(){this.data={},this.$emit("cancel")},save:function(){if(this.isedit){var e=(0,s.default)({},this.data);this.$emit("update",e)}else{this.disabledSave=!0;var t=(0,s.default)({},this.data);this.$emit("save",t)}},remove:function(){this.$emit("remove",{id:this.data.id})},showInfo:function(){this.$emit("showinfo",this.computedRoleOptions)},getPhone:function(e){this.data.mobile=e.formattedNumber}}}},D7I4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=c(a("QbLZ")),i=c(a("OyzN")),n=c(a("P2sY")),o=a("xCek"),l=a("c/X4"),r=c(a("vDqi")),d=c(a("R6vn"));function c(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{loading:!0,loadingItems:!1,saved:!1,data:[],isEditing:[],showForm:!1,showFormEdit:!1,disabledButton:!1,tmp:{},selectedRole:null,roles:[],params:{search:"",per_page:20,sort_column:"view_order",sort_type:"asc"},dialogVisible:!1,computedRoleOptions:[],dataRoles:[]}},components:{GroupForm:d.default},computed:{selectedStore:function(){return this.$store.getters.selectedStore},token:function(){return this.$store.state.user.token},lang:function(){return this.$store.state.userStores.lang},langId:function(){return this.$store.state.userStores.langId}},watch:{"$store.getters.selectedStore":function(){this.getData()}},mounted:function(){this.getData(),this.getRoles()},methods:{getData:function(){var e=this;this.loading=!0;var t={Authorization:"Bearer "+this.token.access_token};(0,r.default)({method:"GET",url:(0,o.baseApi)(this.selectedStore.url_id,this.langId,"staffs/"),params:this.params,headers:t}).then(function(t){e.data=t.data.data,e.data.map(function(t){"SP"===t.id&&(t.info=e.$lang[e.langId].info_role_supervisor),"AS"===t.id&&(t.info=e.$lang[e.langId].info_role_assistant_supervisor),"ST"===t.id&&(t.info=e.$lang[e.langId].info_role_staff),"PO"===t.id&&(t.info=e.$lang[e.langId].info_role_staff_pos),"PS"===t.id&&(t.info=e.$lang[e.langId].info_role_staff_pos_senior),"RP"===t.id&&(t.info=e.$lang[e.langId].info_role_staff_report),"SA"===t.id&&(t.info=e.$lang[e.langId].info_role_admin_sales),"PT"===t.id&&(t.info=e.$lang[e.langId].info_role_purchase_stock),"SS"===t.id&&(t.info=e.$lang[e.langId].info_role_sales_stock),"OW"===t.id&&(t.info=e.$lang[e.langId].info_role_owner)}),e.loading=!1}).catch(function(t){e.loading=!1,401===t.response.data.error.status_code?e.$router.push("/selectstore"):e.$notify({type:"warning",title:"Error",message:t.response.data.error.error})})},add:function(e){this.selectedRole=e,this.showForm=!0},update:function(e){var t=this;this.loadingItems=!0;var a=(0,n.default)({},e),s={Authorization:"Bearer "+this.token.access_token};(0,r.default)({url:(0,o.baseApi)(this.selectedStore.url_id,this.langId,"staffs/updateattr/"+e.id),method:"PUT",headers:s,data:a}).then(function(e){t.$message({type:"success",message:"saved"}),t.loadingItems=!1,t.getData()}).catch(function(e){t.loadingItems=!1,t.$notify({type:"warning",title:e.response.data.error.message,message:e.response.data.error.error})})},save:function(e){var t=this;this.loading=!0;var a={Authorization:"Bearer "+this.token.access_token};(0,r.default)({method:"POST",url:(0,o.baseApi)(this.selectedStore.url_id,this.langId,"staffs/store"),headers:a,data:e}).then(function(e){t.loading=!1,t.saved=!0,t.showForm=!1,t.getData(),t.$message({type:"success",message:"saved"})}).catch(function(e){if(t.saved=!1,t.loading=!1,"string"==typeof e.response.data.error.error)t.$notify({type:"warning",title:e.response.data.error.message,message:e.response.data.error.error});else{var a=(0,i.default)(e.response.data.error.error);if(a.length>=2){var s=[];a.map(function(t,a){s.push(e.response.data.error.error[t][0])});var n=s.join(", ");t.$notify({type:"warning",title:e.response.data.error.message,message:n})}else t.$notify({type:"warning",title:e.response.data.error.message,message:e.response.data.error.error[a[0]][0]})}})},edit:function(e,t){this.tmp={},e.role_id=t.id,e.staff_id=e.id,this.showFormEdit=!0,this.tmp=(0,n.default)({},e)},remove:function(e,t){var a=this;this.loadingItems=!0;var s={Authorization:"Bearer "+this.token.access_token};(0,r.default)({method:"DELETE",url:(0,o.baseApi)(this.selectedStore.url_id,this.langId,"staffs/delete/"+e.id),headers:s}).then(function(e){a.loadingItems=!1,a.getData(),a.$message({type:"success",message:e.data.data.message})}).catch(function(e){a.$notify({type:"warning",title:e.response.data.error.message,message:e.response.data.error.error}),a.loadingItems=!1})},cancel:function(){this.showForm=!1,this.showFormEdit=!1},cancelManageItems:function(e){this.isEditing.map(function(e){e.editing=!1,e.block=""})},remPass:function(e){this.data.map(function(t,a){0!=t.total_user&&t.users.map(function(t){if(t.id===e.id)return t.password=""})})},showRole:function(e){this.computedRoleOptions=e,this.dialogVisible=!0},handleUpdate:function(e){this.showFormEdit=!1,this.update(e)},getRoles:function(){var e=this;this.loading=!0;(0,l.getUserRole)({sort_column:"view_order",sort_type:"asc"}).then(function(t){e.dataRoles=t.data.data,e.dataRoles.map(function(t){"OW"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_owner),"SP"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_supervisor),"AS"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_assistant_supervisor),"ST"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_staff),"PO"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_staff_pos),"PS"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_staff_pos_senior),"RP"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_staff_report),"SA"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_admin_sales),"PT"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_purchase_stock),"SS"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_sales_stock),"LW"===t.id&&(t.label=t.name,t.desc=e.$lang[e.$store.state.userStores.langId].info_role_logistics_warehouse),"PJ"===t.id&&(t.label=t.name,t.desc="")});var a={L:["OW"],B:["OW","PO","PS"],F:[],P:[]};e.dataRoles.map(function(t){"F"!==e.selectedStore.plan_type_id&&"P"!==e.selectedStore.plan_type_id?a[e.selectedStore.plan_type_id].includes(t.id)&&e.roles.push((0,s.default)({},t)):e.roles.push((0,s.default)({},t))}),e.loading=!1}).catch(function(t){e.loading=!1,401===t.response.data.error.status_code||e.$notify({type:"warning",title:"Error",message:t.response.data.error.error})})}}}},HUnS:function(e,t,a){"use strict";a.r(t);var s=a("UkOR"),i=a("V3d8");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,function(){return i[e]})}(n);var o=a("KHd+"),l=Object(o.a)(i.default,s.a,s.b,!1,null,null,null);l.options.__file="Index.vue",t.default=l.exports},OyzN:function(e,t,a){e.exports={default:a("fSc9"),__esModule:!0}},R6vn:function(e,t,a){"use strict";a.r(t);var s=a("cBei"),i=a("+rog");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,function(){return i[e]})}(n);var o=a("KHd+"),l=Object(o.a)(i.default,s.a,s.b,!1,null,null,null);l.options.__file="Form.vue",t.default=l.exports},UkOR:function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"b",function(){return i});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e._l(e.data,function(t,s){return a("el-card",{key:s,staticClass:"box-card no-padding",attrs:{shadow:"never"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.name))]),e._v(" "),"OW"!==t.id?a("button-action-authenticated",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(a){return e.add(t.id)}}},[e._v("\n        "+e._s(e.lang.add)+"\n      ")]):e._e(),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#AAA"}},[e._v(e._s(t.info))])],1),e._v(" "),a("div",{staticClass:"card-body"},[a("div",{staticClass:"like-tr-wrapper"},e._l(t.users,function(s,i){return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingItems,expression:"loadingItems"}],key:i,staticClass:"like-tr clearfix"},[a("div",{staticClass:"width-200 like-tr-item"},[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"pull-left",staticStyle:{"padding-left":"8px"}},[e._v("\n                "+e._s(s.name)),a("br"),e._v(" "),a("span",{staticClass:"size-11"},[e._v(e._s(s.email))])])])]),e._v(" "),a("div",{staticClass:"width-140 like-tr-item"},[a("div",{staticClass:"editable-field"},[a("span",{staticClass:"size-12 editable-field-header"},[e._v("\n                "+e._s(e.lang.pos_access_id)+"\n              ")]),e._v(" "),a("el-input",{attrs:{type:"text",size:"small",placeholder:e.$lang[e.langId].please_input+e.lang.pos_access_id},on:{change:function(t){return e.update(s)}},model:{value:s.code,callback:function(t){e.$set(s,"code",t)},expression:"user.code"}})],1)]),e._v(" "),a("div",{staticClass:"width-120 like-tr-item"},[a("span",{staticClass:"size-12"},[e._v("\n              "+e._s(e.lang.pos_served_by)+"\n            ")]),e._v(" "),a("div",{staticStyle:{"margin-bottom":"8px"}}),e._v(" "),a("el-switch",{attrs:{"active-value":"1","inactive-value":"0",size:"small"},on:{change:function(t){return e.update(s)}},model:{value:s.is_server,callback:function(t){e.$set(s,"is_server",t)},expression:"user.is_server"}})],1),e._v(" "),"OW"!==t.id?a("div",{staticClass:"width-60 like-tr-item flex-container"},[a("el-button",{staticClass:"btn-delete",attrs:{type:"text",icon:"el-icon-delete",size:"default"},on:{click:function(a){return e.remove(s,t)}}}),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.edit(s,t)}}},[a("svg-icon",{staticClass:"ml-10",attrs:{"icon-class":"edit-2"}})],1)],1):e._e()])}),0)])])}),e._v(" "),a("el-dialog",{attrs:{visible:e.showForm,"before-close":e.cancel,"custom-class":"without-padding dialog-without-header"},on:{"update:visible":function(t){e.showForm=t}}},[a("group-form",{attrs:{saved:e.saved,loading:e.loading,"role-options":e.roles,"selected-role":e.selectedRole},on:{save:e.save,cancel:e.cancel,showinfo:e.showRole}})],1),e._v(" "),a("el-dialog",{attrs:{visible:e.showFormEdit,"before-close":e.cancel,"custom-class":"without-padding dialog-without-header"},on:{"update:visible":function(t){e.showFormEdit=t}}},[a("group-form",{attrs:{staff:e.tmp,isedit:!0,saved:e.saved,loading:e.loading,"role-options":e.roles,"selected-role":e.selectedRole},on:{update:e.handleUpdate,cancel:e.cancel,showinfo:e.showRole}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.lang.info_staff_title,visible:e.dialogVisible,width:"420px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"tips-list"},[e._l(e.computedRoleOptions,function(t,s){return[a("div",{key:s},[a("h5",[e._v(e._s(t.label))]),e._v(" "),a("p",[e._v(e._s(t.desc))]),e._v(" "),a("hr")])]})],2)])])],2)},i=[]},V3d8:function(e,t,a){"use strict";a.r(t);var s=a("D7I4"),i=a.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,function(){return s[e]})}(n);t.default=i.a},cBei:function(e,t,a){"use strict";a.d(t,"a",function(){return s}),a.d(t,"b",function(){return i});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("div",{staticClass:"flex-container flex-container--content-space-between",attrs:{slot:"header"},slot:"header"},[e.isedit?a("h4",[e._v(e._s(e.$lang[e.langId].edit_staff))]):a("h4",[e._v(e._s(e.lang.add_staff))]),e._v(" "),a("div",{staticClass:"text-right"},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:e.cancel}},[e._v("\n          "+e._s(e.lang.cancel)+"\n        ")]),e._v(" "),e.isedit?a("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-check"},on:{click:e.save}},[e._v("\n          "+e._s(e.lang.save)+"\n        ")]):a("el-button",{attrs:{disabled:e.disabledSave,size:"small",type:"success",icon:"el-icon-check"},on:{click:e.save}},[e._v("\n          "+e._s(e.lang.save)+"\n        ")])],1)]),e._v(" "),e.isedit?a("div",{staticClass:"p-24"},[a("el-form",{attrs:{"label-width":"140px"},model:{value:e.staff,callback:function(t){e.staff=t},expression:"staff"}},[a("el-form-item",{attrs:{label:e.lang.role,required:!0}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.data.role_id,callback:function(t){e.$set(e.data,"role_id",t)},expression:"data.role_id"}},e._l(e.computedRoleOptions,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.label,disabled:e.disabled}})}),1),e._v(" "),a("p",{staticClass:"size-12 input-desc oldgrey cursor-pointer clickable",on:{click:e.showInfo}},[e._v("\n            "+e._s(e.lang.click_to_view_roles_info)+"\n          ")])],1),e._v(" "),a("hr"),e._v(" "),a("el-form-item",{attrs:{label:e.lang.pos_access_id}},[a("el-input",{attrs:{type:"text"},model:{value:e.data.code,callback:function(t){e.$set(e.data,"code",t)},expression:"data.code"}})],1),e._v(" "),e.data.email?e._e():a("el-form-item",{attrs:{label:e.lang.password}},[a("el-input",{attrs:{type:"text"},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}}),e._v(" "),a("p",{staticClass:"input-desc oldgrey size-12"},[e._v("\n            "+e._s(e.lang.info_staff_password)+"\n          ")])],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.pos_served_by}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.lang.yes,"inactive-text":e.lang.no},model:{value:e.data.is_server,callback:function(t){e.$set(e.data,"is_server",t)},expression:"data.is_server"}}),e._v(" "),a("p",{staticClass:"input-desc oldgrey size-12"},[e._v("\n            "+e._s(e.lang.info_pos_served_by)+"\n          ")])],1)],1)],1):a("div",{staticClass:"card-body p-24"},[a("el-form",{attrs:{model:e.data,"label-width":"140px"}},[a("el-form-item",{attrs:{label:e.lang.name,required:!0}},[a("el-input",{attrs:{type:"text"},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.email}},[a("el-input",{attrs:{type:"email"},model:{value:e.data.email,callback:function(t){e.$set(e.data,"email",t)},expression:"data.email"}}),e._v(" "),a("p",{staticClass:"input-desc oldgrey size-12"},[e._v("\n            "+e._s(e.lang.info_staff_email)+"\n          ")])],1),e._v(" "),"setdemo1"===e.selectedStore.url_id||"allinolsera2"===e.selectedStore.url_id?a("el-form-item",{attrs:{label:e.lang.phone,required:!0}},[a("phone-number-input",{staticClass:"field-register",attrs:{translations:{countrySelectorLabel:"",countrySelectorError:"",phoneNumberLabel:"",example:""},"only-countries":["ID","SG"],"default-country-code":"ID"},on:{update:e.getPhone},model:{value:e.data.phone_format,callback:function(t){e.$set(e.data,"phone_format",t)},expression:"data.phone_format"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:e.lang.role,required:!0}},[a("el-select",{staticStyle:{width:"100%"},model:{value:e.data.role_id,callback:function(t){e.$set(e.data,"role_id",t)},expression:"data.role_id"}},e._l(e.computedRoleOptions,function(e){return a("el-option",{key:e.id,attrs:{value:e.id,label:e.label,disabled:e.disabled}})}),1),e._v(" "),a("p",{staticClass:"size-12 input-desc oldgrey cursor-pointer clickable",on:{click:e.showInfo}},[e._v("\n            "+e._s(e.lang.click_to_view_roles_info)+"\n          ")])],1),e._v(" "),a("hr"),e._v(" "),a("el-form-item",{attrs:{label:e.lang.pos_access_id}},[a("el-input",{attrs:{type:"text"},model:{value:e.data.code,callback:function(t){e.$set(e.data,"code",t)},expression:"data.code"}})],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.password}},[a("el-input",{attrs:{type:"text"},model:{value:e.data.password,callback:function(t){e.$set(e.data,"password",t)},expression:"data.password"}}),e._v(" "),a("p",{staticClass:"input-desc oldgrey size-12"},[e._v("\n            "+e._s(e.lang.info_staff_password)+"\n          ")])],1),e._v(" "),a("el-form-item",{attrs:{label:e.lang.pos_served_by}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":e.lang.yes,"inactive-text":e.lang.no},model:{value:e.data.is_server,callback:function(t){e.$set(e.data,"is_server",t)},expression:"data.is_server"}}),e._v(" "),a("p",{staticClass:"input-desc oldgrey size-12"},[e._v("\n            "+e._s(e.lang.info_pos_served_by)+"\n          ")])],1)],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.lang.info_staff_title,visible:e.dialogVisible,width:"320px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"tips-list"},[e._l(e.computedRoleOptions,function(t,s){return[a("div",{key:s},[a("h5",[e._v(e._s(t.label))]),e._v(" "),a("p",[e._v(e._s(t.desc))]),e._v(" "),a("hr")])]})],2)])])],1)},i=[]},fSc9:function(e,t,a){a("kla0");var s=a("VSTI").Object;e.exports=function(e){return s.getOwnPropertyNames(e)}},kla0:function(e,t,a){a("czaS")("getOwnPropertyNames",function(){return a("GDZC").f})}}]);